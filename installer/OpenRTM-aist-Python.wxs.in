<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">   
  <?if $(env.ARCH) = x86 ?>
  <Product Name='$(env.PRODUCT_NAME)'
           Id="{% Product.Id %}"
           Language='$(var.language)'
           Codepage='$(var.codepage)'
           Version="{% Product.Version %}" 
           Manufacturer="{% Product.Manufacturer %}"
           UpgradeCode="{% Product.UpgradeCode_x86 %}">
  <?else?>
  <Product Name='$(env.PRODUCT_NAME)'
           Id="{% Product.Id %}"
           Language='$(var.language)'
           Codepage='$(var.codepage)'
           Version="{% Product.Version %}" 
           Manufacturer="{% Product.Manufacturer %}"
           UpgradeCode="{% Product.UpgradeCode_x86_64 %}">
  <?endif ?>

    <Package Id="*" 
             Keywords="Installer"
             Description="{% Package.Description %}"
             InstallerVersion="{% Package.InstallerVersion %}"
             Languages='$(var.language)'
             Compressed="{% Package.Compressed %}"
             SummaryCodepage='$(var.codepage)' />

    <!-- Property -->
    <Property Id='USERPROFILEDIR' Value='%USERPROFILE%' />

    <?if $(env.ARCH) = x86_64 ?>
    <Property Id="PYTHON26">
      <RegistrySearch Id="Python26"
                      Root="HKLM"
                      Key="SOFTWARE\Python\PythonCore\2.6\InstallPath"
					  Win64="yes"
                      Type="raw" />
    </Property>

    <Property Id="PYTHON27">
      <RegistrySearch Id="Python27"
                      Root="HKLM"
                      Key="SOFTWARE\Python\PythonCore\2.7\InstallPath"
					  Win64="yes"
                      Type="raw" />
    </Property>
	<?else?>
    <Property Id="PYTHON26">
      <RegistrySearch Id="Python26"
                      Root="HKLM"
                      Key="SOFTWARE\Python\PythonCore\2.6\InstallPath"
                      Type="raw" />
    </Property>

    <Property Id="PYTHON27">
      <RegistrySearch Id="Python27"
                      Root="HKLM"
                      Key="SOFTWARE\Python\PythonCore\2.7\InstallPath"
                      Type="raw" />
    </Property>
	<?endif ?>

    <SetProperty Id="PYTHON26DIR" After="AppSearch" Value="[PYTHON26]">
    </SetProperty>

    <SetProperty Id="PYTHON27DIR" After="AppSearch" Value="[PYTHON27]">
    </SetProperty>

    <?if $(env.ARCH) = x86 ?>
    <Upgrade Id="{% Product.UpgradeCode_x86 %}">
    <?else?>
    <Upgrade Id="{% Product.UpgradeCode_x86_64 %}">
    <?endif ?>
      <UpgradeVersion OnlyDetect="yes"
                      Minimum="1.0.0"
                      Maximum="1.1.0"
                      Property="NEWERVERSIONDETECTED"
                      IncludeMinimum="no" /> 
      <UpgradeVersion OnlyDetect="no"
                      Minimum="1.0.0"
                      Maximum="1.1.0.1"
                      Property="OLDERVERSIONBEINGUPGRADED"
                      IncludeMaximum="no" /> 
      <UpgradeVersion OnlyDetect='no' Property='PREVIOUSFOUND'
                      Minimum='1.0.0' IncludeMinimum='yes'
                      Maximum='1.1.0' IncludeMaximum='no' />
    <?if $(env.ARCH) = x86 ?>
    </Upgrade>
    <?else?>
    </Upgrade>
    <?endif ?>

    <InstallExecuteSequence>
      <RemoveExistingProducts Before="InstallInitialize"/>

      <Custom Action="IDLCOMPILE_PY26" After='InstallFinalize'>
	NOT Installed AND PYTHON26
      </Custom>

      <Custom Action="IDLCOMPILE_PY27" After='InstallFinalize'>
	NOT Installed AND PYTHON27
      </Custom>

      <Custom Action="REMOVEFOLDER_PY26" Before='InstallInitialize'>
	Installed AND PYTHON26
      </Custom>

      <Custom Action="REMOVEFOLDER_PY27" Before='InstallInitialize'>
	Installed AND PYTHON27
      </Custom>

      <Custom Action="REMOVEFOLDER_RTM" Before='InstallInitialize'>Installed</Custom>

    </InstallExecuteSequence>

    <Media Id="1" Cabinet="OpenRTMpython.cab" EmbedCab="yes"/>

    <!-- enable this value when you want register to ALL User -->
    <!-- <Property Id="ALLUSERS" Value="1" /> -->

    <Condition Message="[ProductName] requires python 2.6 or 2.7">
      <![CDATA[Installed OR (PYTHON26 <> "" OR PYTHON27 <> "")]]>
    </Condition>


    <Directory Id="TARGETDIR" Name="SourceDir">

      <!-- for Python26 -->
      <Directory Id="PYTHON26DIR" Name="[[PYTHON26]]">
        <!-- omniORBpy components -->
        <?include omniORBpy26_inc.wxs ?>
        <!-- end of omniORBpy -->

        <!-- rtcprof -->
        <Component Id="Py26_RtmOpenrtm_aistUtilsRtcprof" 
                   Guid="{% RtmOpenrtm_aist26UtilsRtcprof.GUID %}">
          <RemoveFile Id='Py26_RtmOpenrtm_aistUtilsRtcprof' On='uninstall' Name='*.pyc' />
          <RemoveFile Id='Py26_RtmOpenrtm_aistUtilsRtcprof_2' On='uninstall' Name='rtc*.log' />
          {% for file in RtmOpenrtm_aist26UtilsRtcprof.Files %}
          <File Id="{% file.Id %}" Name="{% file.Name %}"
                DiskId="1" Source="{% file.Source %}">
          </File>
          {% endfor %}
        </Component>

        <!-- rtcd -->
        <Component Id="Py26_RtmOpenrtm_aistUtilsRtcd" 
                   Guid="{% RtmOpenrtm_aist26UtilsRtcd.GUID %}">
          {% for file in RtmOpenrtm_aist26UtilsRtcd.Files %}
          <File Id="{% file.Id %}" Name="{% file.Name %}"
                DiskId="1" Source="{% file.Source %}">
            {% if file.Name is rtcd.py %}
            <Shortcut Id="{% file.Id %}" Directory="ToolsMenuFolder"
                      Name="Start RTC daemon"
                      Arguments=' -d -f "[Version]examples\Python\rtcd.conf"'
                      Show="normal" WorkingDirectory="bin"/>
			{% endif %}
            {% if file.Name is rtcd.conf %}
            <Shortcut Id="{% file.Id %}" Directory="ToolsMenuFolder"
                      Name="rtc.conf for RTC daemon"
                      Show="normal" WorkingDirectory="bin"/>
			{% endif %}
          </File>
          {% endfor %}
        </Component>

        <!-- Lib -->
        <Directory Id="py26Lib" Name="Lib">
          <!-- site-packages -->
          <Directory Id="Py26_site_packages" Name="site-packages">

            <Component Id="Py26_RtmOpenrtm_aistRoot" 
                       Guid="{% RtmOpenrtm_aist26Root.GUID %}">
              <RemoveFile Id='Py26_RtmOpenrtm_aistRoot' On='uninstall' Name='*.pyc' />
              {% for file in RtmOpenrtm_aist26Root.Files %}
              <File Id="{% file.Id %}" Name="{% file.Name %}"
                    DiskId="1" Source="{% file.Source %}">
              </File>
              {% endfor %}
            </Component>

            <!-- OpenRTM_aist -->
            <Directory Id="Py26_OpenRTM_aist" Name="OpenRTM_aist">
              <Component Id="Py26_RtmOpenrtm_aist" 
                         Guid="{% RtmOpenrtm_aist26.GUID %}">
                <RemoveFile Id='Py26_RtmOpenrtm_aist' On='uninstall' Name='*.pyc' />
                <RemoveFolder Id='Py26_RtmOpenrtm_aist_f' On='uninstall' />
                {% for file in RtmOpenrtm_aist26.Files %}
                <File Id="{% file.Id %}" Name="{% file.Name %}"
                      DiskId="1" Source="{% file.Source %}">
                </File>
                {% endfor %}
              </Component>

              <!-- rtc-template -->
              <Directory Id="Py26_rtc_template" Name="rtc-template">
                <Component Id="Py26_RtmOpenrtm_aistRtctemplate" 
                           Guid="{% RtmOpenrtm_aist26UtilsRtctemplate.GUID %}">
                  <RemoveFile Id='Py26_RtmOpenrtm_aistRtctemplate' On='uninstall' Name='*.pyc' />
                  <RemoveFolder Id='Py26_RtmOpenrtm_aistRtctemplate_f' On='uninstall' />
                  {% for file in RtmOpenrtm_aist26UtilsRtctemplate.Files %}
                  <File Id="{% file.Id %}" Name="{% file.Name %}"
                        DiskId="1" Source="{% file.Source %}">
                  </File>
                  {% endfor %}
                </Component>
              </Directory>

              <!-- observer -->
              <Directory Id="Py26_ext" Name="ext">
                <Component Id="Py26_RtmOpenrtm_aistExt" 
                           Guid="{% RtmOpenrtm_aist26Ext.GUID %}">
                  <RemoveFile Id='Py26_RtmOpenrtm_aistExt' On='uninstall' Name='*.pyc' />
                  <RemoveFolder Id='Py26_RtmOpenrtm_aistExt_f' On='uninstall' />
                  {% for file in RtmOpenrtm_aist26Ext.Files %}
                  <File Id="{% file.Id %}" Name="{% file.Name %}"
                        DiskId="1" Source="{% file.Source %}">
                  </File>
                  {% endfor %}
                </Component>
				<Directory Id="Py26_sdo" Name="sdo">
                  <Component Id="Py26_RtmOpenrtm_aistExtSdo" 
							 Guid="{% RtmOpenrtm_aist26ExtSdo.GUID %}">
					<RemoveFile Id='Py26_RtmOpenrtm_aistExtSdo' On='uninstall' Name='*.pyc' />
					<RemoveFolder Id='Py26_RtmOpenrtm_aistExtSdo_f' On='uninstall' />
					{% for file in RtmOpenrtm_aist26ExtSdo.Files %}
					<File Id="{% file.Id %}" Name="{% file.Name %}"
                          DiskId="1" Source="{% file.Source %}">
					</File>
					{% endfor %}
                  </Component>
				  <Directory Id="Py26_observer" Name="observer">
					<Component Id="Py26_RtmOpenrtm_aistExtSdoObserver" 
							   Guid="{% RtmOpenrtm_aist26ExtSdoObserver.GUID %}">
					  <RemoveFile Id='Py26_RtmOpenrtm_aistExtSdoObserver' On='uninstall' Name='*.pyc' />
					  <RemoveFolder Id='Py26_RtmOpenrtm_aistExtSdoObserver_f' On='uninstall' />
					  {% for file in RtmOpenrtm_aist26ExtSdoObserver.Files %}
					  <File Id="{% file.Id %}" Name="{% file.Name %}"
							DiskId="1" Source="{% file.Source %}">
					  </File>
					  {% endfor %}
					</Component>
				  </Directory>

				</Directory>
              </Directory>

              <!-- RTM_IDL -->
              <Directory Id="Py26_RTM_IDL" Name="RTM_IDL">
                <Component Id="Py26_RtmOpenrtm_aistRtm_idl" 
                           Guid="{% RtmOpenrtm_aist26Rtm_idl.GUID %}">
                  <RemoveFile Id='Py26_RtmOpenrtm_aistRtm_idl' On='uninstall' Name='*.pyc' />
                  <RemoveFolder Id='Py26_RtmOpenrtm_aistRtm_idl_f' On='uninstall' />
                  {% for file in RtmOpenrtm_aist26Rtm_idl.Files %}
                  <File Id="{% file.Id %}" Name="{% file.Name %}"
                        DiskId="1" Source="{% file.Source %}">
                  </File>
                  {% endfor %}
                </Component>

                <!-- device_interfaces -->
                <Directory Id="Py26_device_interfaces" Name="device_interfaces">
                  <Component Id="Py26_RtmOpenrtm_aistRtm_idlDevice_interfaces" 
                             Guid="{% RtmOpenrtm_aist26Rtm_idlDevice_interfaces.GUID %}">
                    <RemoveFile Id='Py26_RtmOpenrtm_aistRtm_idlDevice_interfaces' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='Py26_RtmOpenrtm_aistRtm_idlDevice_interfaces_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aist26Rtm_idlDevice_interfaces.Files %}
                    <File Id="{% file.Id %}" Name="{% file.Name %}"
                          DiskId="1" Source="{% file.Source %}">
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>
              </Directory>

            <!-- end of OpenRTM_aist -->
            </Directory>

          <!-- end of site-packages -->
          </Directory>

        <!-- end of Lib -->
        </Directory>
      </Directory>

      <!-- for Python27 -->
      <Directory Id="PYTHON27DIR" Name="[[PYTHON27]]">
        <!-- omniORBpy components -->
        <?include omniORBpy27_inc.wxs ?>
        <!-- end of omniORBpy -->

        <!-- rtcprof -->
        <Component Id="Py27_RtmOpenrtm_aistUtilsRtcprof" 
                   Guid="{% RtmOpenrtm_aist27UtilsRtcprof.GUID %}">
          <RemoveFile Id='Py27_RtmOpenrtm_aistUtilsRtcprof' On='uninstall' Name='*.pyc' />
          <RemoveFile Id='Py27_RtmOpenrtm_aistUtilsRtcprof_2' On='uninstall' Name='rtc*.log' />
          {% for file in RtmOpenrtm_aist27UtilsRtcprof.Files %}
          <File Id="{% file.Id %}" Name="{% file.Name %}"
                DiskId="1" Source="{% file.Source %}">
          </File>
          {% endfor %}
        </Component>

        <!-- rtcd -->
        <Component Id="Py27_RtmOpenrtm_aistUtilsRtcd" 
                   Guid="{% RtmOpenrtm_aist27UtilsRtcd.GUID %}">
          {% for file in RtmOpenrtm_aist27UtilsRtcd.Files %}
          <File Id="{% file.Id %}" Name="{% file.Name %}"
                DiskId="1" Source="{% file.Source %}">
            {% if file.Name is rtcd.py %}
            <Shortcut Id="{% file.Id %}" Directory="ToolsMenuFolder"
                      Name="Start RTC daemon"
                      Arguments=' -d -f "[Version]examples\Python\rtcd.conf"'
                      Show="normal" WorkingDirectory="bin"/>
			{% endif %}
            {% if file.Name is rtcd.conf %}
            <Shortcut Id="{% file.Id %}" Directory="ToolsMenuFolder"
                      Name="rtc.conf for RTC daemon"
                      Show="normal" WorkingDirectory="bin"/>
			{% endif %}
          </File>
          {% endfor %}
        </Component>

        <!-- Lib -->
        <Directory Id="py27Lib" Name="Lib">
          <!-- site-packages -->
          <Directory Id="Py27_site_packages" Name="site-packages">

            <Component Id="Py27_RtmOpenrtm_aistRoot" 
                       Guid="{% RtmOpenrtm_aist27Root.GUID %}">
              <RemoveFile Id='Py27_RtmOpenrtm_aistRoot' On='uninstall' Name='*.pyc' />
              {% for file in RtmOpenrtm_aist27Root.Files %}
              <File Id="{% file.Id %}" Name="{% file.Name %}"
                    DiskId="1" Source="{% file.Source %}">
              </File>
              {% endfor %}
            </Component>

            <!-- OpenRTM_aist -->
            <Directory Id="Py27_OpenRTM_aist" Name="OpenRTM_aist">
              <Component Id="Py27_RtmOpenrtm_aist" 
                         Guid="{% RtmOpenrtm_aist27.GUID %}">
                <RemoveFile Id='Py27_RtmOpenrtm_aist' On='uninstall' Name='*.pyc' />
                <RemoveFolder Id='Py27_RtmOpenrtm_aist_f' On='uninstall' />
                {% for file in RtmOpenrtm_aist27.Files %}
                <File Id="{% file.Id %}" Name="{% file.Name %}"
                      DiskId="1" Source="{% file.Source %}">
                </File>
                {% endfor %}
              </Component>

              <!-- rtc-template -->
              <Directory Id="Py27_rtc_template" Name="rtc-template">
                <Component Id="Py27_RtmOpenrtm_aistRtctemplate" 
                           Guid="{% RtmOpenrtm_aist27UtilsRtctemplate.GUID %}">
                  <RemoveFile Id='Py27_RtmOpenrtm_aistRtctemplate' On='uninstall' Name='*.pyc' />
                  <RemoveFolder Id='Py27_RtmOpenrtm_aistRtctemplate_f' On='uninstall' />
                  {% for file in RtmOpenrtm_aist27UtilsRtctemplate.Files %}
                  <File Id="{% file.Id %}" Name="{% file.Name %}"
                        DiskId="1" Source="{% file.Source %}">
                  </File>
                  {% endfor %}
                </Component>
              </Directory>

              <!-- observer -->
              <Directory Id="Py27_ext" Name="ext">
                <Component Id="Py27_RtmOpenrtm_aistExt" 
                           Guid="{% RtmOpenrtm_aist27Ext.GUID %}">
                  <RemoveFile Id='Py27_RtmOpenrtm_aistExt' On='uninstall' Name='*.pyc' />
                  <RemoveFolder Id='Py27_RtmOpenrtm_aistExt_f' On='uninstall' />
                  {% for file in RtmOpenrtm_aist27Ext.Files %}
                  <File Id="{% file.Id %}" Name="{% file.Name %}"
                        DiskId="1" Source="{% file.Source %}">
                  </File>
                  {% endfor %}
                </Component>
				<Directory Id="Py27_sdo" Name="sdo">
                  <Component Id="Py27_RtmOpenrtm_aistExtSdo" 
							 Guid="{% RtmOpenrtm_aist27ExtSdo.GUID %}">
					<RemoveFile Id='Py27_RtmOpenrtm_aistExtSdo' On='uninstall' Name='*.pyc' />
					<RemoveFolder Id='Py27_RtmOpenrtm_aistExtSdo_f' On='uninstall' />
					{% for file in RtmOpenrtm_aist27ExtSdo.Files %}
					<File Id="{% file.Id %}" Name="{% file.Name %}"
                          DiskId="1" Source="{% file.Source %}">
					</File>
					{% endfor %}
                  </Component>
				  <Directory Id="Py27_observer" Name="observer">
					<Component Id="Py27_RtmOpenrtm_aistExtSdoObserver" 
							   Guid="{% RtmOpenrtm_aist27ExtSdoObserver.GUID %}">
					  <RemoveFile Id='Py27_RtmOpenrtm_aistExtSdoObserver' On='uninstall' Name='*.pyc' />
					  <RemoveFolder Id='Py27_RtmOpenrtm_aistExtSdoObserver_f' On='uninstall' />
					  {% for file in RtmOpenrtm_aist27ExtSdoObserver.Files %}
					  <File Id="{% file.Id %}" Name="{% file.Name %}"
							DiskId="1" Source="{% file.Source %}">
					  </File>
					  {% endfor %}
					</Component>
				  </Directory>

				</Directory>
              </Directory>

              <!-- RTM_IDL -->
              <Directory Id="Py27_RTM_IDL" Name="RTM_IDL">
                <Component Id="Py27_RtmOpenrtm_aistRtm_idl" 
                           Guid="{% RtmOpenrtm_aist27Rtm_idl.GUID %}">
                  <RemoveFile Id='Py27_RtmOpenrtm_aistRtm_idl' On='uninstall' Name='*.pyc' />
                  <RemoveFolder Id='Py27_RtmOpenrtm_aistRtm_idl_f' On='uninstall' />
                  {% for file in RtmOpenrtm_aist27Rtm_idl.Files %}
                  <File Id="{% file.Id %}" Name="{% file.Name %}"
                        DiskId="1" Source="{% file.Source %}">
                  </File>
                  {% endfor %}
                </Component>

                <!-- device_interfaces -->
                <Directory Id="Py27_device_interfaces" Name="device_interfaces">
                  <Component Id="Py27_RtmOpenrtm_aistRtm_idlDevice_interfaces" 
                             Guid="{% RtmOpenrtm_aist27Rtm_idlDevice_interfaces.GUID %}">
                    <RemoveFile Id='Py27_RtmOpenrtm_aistRtm_idlDevice_interfaces' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='Py27_RtmOpenrtm_aistRtm_idlDevice_interfaces_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aist27Rtm_idlDevice_interfaces.Files %}
                    <File Id="{% file.Id %}" Name="{% file.Name %}"
                          DiskId="1" Source="{% file.Source %}">
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>
              </Directory>

            <!-- end of OpenRTM_aist -->
            </Directory>

          <!-- end of site-packages -->
          </Directory>

        <!-- end of Lib -->
        </Directory>
      </Directory>


      <!-- Program Files -->
      <?if $(env.ARCH) = x86 ?>
      <Directory Id="ProgramFilesFolder" SourceName="PFILE">
      <?else?>
      <Directory Id="ProgramFiles64Folder" SourceName="PFILE">
      <?endif ?>
        <Directory Id="INSTALLLOCATION"
				   Name="{% Product.Name %}">
		  <Directory Id="Version"
					 Name="{% Product.ShortVersion %}">
            <Component Id="ENV_ROOT" Guid="61F1F7A1-7945-11E5-A548-D670D757CAAC">
              <CreateFolder />
              <Environment Id='RTM_ROOT' Name='RTM_ROOT' Action='create'
                  System='yes' Value='[Version]' />
            </Component>

            <!-- JRE -->
            <?if $(env.INCLUDE_JRE) = YES ?>
            <Merge Id="Msi_JRE_OpenJDK" Language="1041"
                  SourceFile="JRE_OpenJDK7_$(env.ARCH).msm" DiskId="1" />
            <?endif ?>
            <!-- end of JRE -->

            <!-- bin -->
            <Directory Id="bin" Name="bin">
              <Component Id="Rtm_Bin" Guid="{% RtmOpenrtm_aistUtilsRtmnaming.GUID %}">
                <RemoveFile Id='Rtm_Bin' On='uninstall' Name='*.pyc' />
                <RemoveFolder Id='Rtm_Bin_f' On='uninstall' />
                {% for file in RtmOpenrtm_aistUtilsRtmnaming.Files %}
                <File Id="{% file.Id %}"
                      Name="{% file.Name %}" DiskId="1"
                      Source="{% file.Source %}">
                  {% if file.Name is rtm-naming.py %}
                  <Shortcut Id="rtmnaming.py" Directory="CommonToolsMenuFolder"
                            Name="Start Python Naming Service"
                            Show="normal" WorkingDirectory="bin"/>
                  {% endif %}
                </File>
                {% endfor %}

              </Component>

              <Component Id="Rtm_Bin2" Guid="{% RtmInstaller.GUID %}">
                <RemoveFile Id='Rtm_Bin2' On='uninstall' Name='*.pyc' />
                <RemoveFolder Id='Rtm_Bin2_f' On='uninstall' />

                {% for file in RtmInstaller.Files %}
                <File Id="{% file.Id %}"
                      Name="{% file.Name %}" DiskId="1"
                      Source="{% file.Source %}">
                </File>
                {% endfor %}

              </Component>
            </Directory>

            <!-- doc -->
            <Directory Id="doc" Name="doc">

              <!-- Python -->
              <Directory Id="Pythondoc" Name="Python">

                <!-- classref_jp -->
                <Directory Id="classref_jp" Name="classref_jp">
                  <Component Id="RtmOpenrtm_aistDocsClassreferencejpHtml" 
                             Guid="{% RtmOpenrtm_aistDocsClassreferencejpHtml.GUID %}">
                    <RemoveFolder Id='RtmOpenrtm_aistDocsClassreferencejpHtml_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistDocsClassreferencejpHtml.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is index.html %}
                      <Shortcut Id="{% file.Id %}" Directory="DocMenuFolder"
                                Name="Japanese Class reference"
                                Show="normal"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>

                <!-- classref_en -->
                <Directory Id="classref_en" Name="classref_en">
                  <Component Id="RtmOpenrtm_aistDocsClassreferenceenHtml" 
                             Guid="{% RtmOpenrtm_aistDocsClassreferenceenHtml.GUID %}">
                    <RemoveFolder Id='RtmOpenrtm_aistDocsClassreferenceenHtml_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistDocsClassreferenceenHtml.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is index.html %}
                      <Shortcut Id="{% file.Id %}" Directory="DocMenuFolder"
                                Name="English Class reference"
                                Show="normal"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>
              </Directory>
            </Directory>

            <!-- examples -->
            <Directory Id="examples" Name="examples">

              <!-- Python -->
              <Directory Id="Pythonexamples" Name="Python">

                <Component Id="RtmOpenrtm_aistExamples" 
                           Guid="{% RtmOpenrtm_aistExamples.GUID %}">
                  {% for file in RtmOpenrtm_aistExamples.Files %}
                  <File Id="{% file.Id %}"
                        Name="{% file.Name %}" DiskId="1"
                        Source="{% file.Source %}">
                  </File>
                  {% endfor %}
                </Component>

                <!-- AutoControl -->
                <Directory Id="AutoControl" Name="AutoControl">
                  <Component Id="RtmOpenrtm_aistExamplesAutocontrol" 
                             Guid="{% RtmOpenrtm_aistExamplesAutocontrol.GUID %}">
                    <RemoveFile Id='RtmOpenrtm_aistExamplesAutocontrol' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='RtmOpenrtm_aistExamplesAutocontrol_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistExamplesAutocontrol.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is AutoControl.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="AutoControl.py"
                                Show="normal" WorkingDirectory="AutoControl"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>

                <!-- Composite -->
                <Directory Id="Composite" Name="Composite">
                  <Component Id="RtmOpenrtm_aistExamplesComposite" 
                             Guid="{% RtmOpenrtm_aistExamplesComposite.GUID %}">
                    <RemoveFile Id='RtmOpenrtm_aistExamplesComposite' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='RtmOpenrtm_aistExamplesComposite_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistExamplesComposite.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is Composite.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="Composite.py"
                                Show="normal" WorkingDirectory="Composite"/>
                      {% endif %}
                      {% if file.Name is Controller.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="Controller.py"
                                Show="normal" WorkingDirectory="Composite"/>
                      {% endif %}
                      {% if file.Name is Motor.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="Motor.py"
                                Show="normal" WorkingDirectory="Composite"/>
                      {% endif %}
                      {% if file.Name is Sensor.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="Sensor.py"
                                Show="normal" WorkingDirectory="Composite"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>

                <!-- ConfigSample -->
                <Directory Id="ConfigSample" Name="ConfigSample">
                  <Component Id="RtmOpenrtm_aistExamplesConfigsample" 
                             Guid="{% RtmOpenrtm_aistExamplesConfigsample.GUID %}">
                    <RemoveFile Id='RtmOpenrtm_aistExamplesConfigsample' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='RtmOpenrtm_aistExamplesConfigsample_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistExamplesConfigsample.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is ConfigSample.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="ConfigSample.py"
                                Show="normal" WorkingDirectory="ConfigSample"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>

                <!-- ExtTrigger -->
                <Directory Id="ExtTrigger" Name="ExtTrigger">
                  <Component Id="RtmOpenrtm_aistExamplesExttrigger" 
                             Guid="{% RtmOpenrtm_aistExamplesExttrigger.GUID %}">
                    <RemoveFile Id='RtmOpenrtm_aistExamplesExttrigger' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='RtmOpenrtm_aistExamplesExttrigger_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistExamplesExttrigger.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>

                <!-- MobileRobotCanvas -->
                <Directory Id="MobileRobotCanvas" Name="MobileRobotCanvas">
                  <Component Id="RtmOpenrtm_aistExamplesMobilerobotcanvas" 
                             Guid="{% RtmOpenrtm_aistExamplesMobilerobotcanvas.GUID %}">
                    <RemoveFile Id='RtmOpenrtm_aistExamplesMobilerobotcanvas' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='RtmOpenrtm_aistExamplesMobilerobotcanvas_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistExamplesMobilerobotcanvas.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is TkMobileRobotSimulator.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="TkMobileRobotSimulator.py"
                                Show="normal" WorkingDirectory="MobileRobotCanvas"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>

                <!-- NXTRTC -->
                <Directory Id="NXTRTC" Name="NXTRTC">
                  <Component Id="RtmOpenrtm_aistExamplesNxtrtc" 
                             Guid="{% RtmOpenrtm_aistExamplesNxtrtc.GUID %}">
                    <RemoveFile Id='RtmOpenrtm_aistExamplesNxtrtc' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='RtmOpenrtm_aistExamplesNxtrtc_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistExamplesNxtrtc.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is NXTRTC.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="NXTRTC.py"
                                Show="normal" WorkingDirectory="NXTRTC"/>
                      {% endif %}
                      {% if file.Name is NXTRTC20.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="NXTRTC20.py"
                                Show="normal" WorkingDirectory="NXTRTC"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>

                <!-- SeqIO -->
                <Directory Id="SeqIO" Name="SeqIO">
                  <Component Id="RtmOpenrtm_aistExamplesSeqio" 
                             Guid="{% RtmOpenrtm_aistExamplesSeqio.GUID %}">
                    <RemoveFile Id='RtmOpenrtm_aistExamplesSeqio' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='RtmOpenrtm_aistExamplesSeqio_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistExamplesSeqio.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is SeqIn.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="SeqIn.py"
                                Show="normal" WorkingDirectory="SeqIO"/>
                      {% endif %}
                      {% if file.Name is SeqOut.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="SeqOut.py"
                                Show="normal" WorkingDirectory="SeqIO"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>

                <!-- SimpleIO -->
                <Directory Id="SimpleIO" Name="SimpleIO">
                  <Component Id="RtmOpenrtm_aistExamplesSimpleio" 
                             Guid="{% RtmOpenrtm_aistExamplesSimpleio.GUID %}">
                    <RemoveFile Id='RtmOpenrtm_aistExamplesSimpleio' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='RtmOpenrtm_aistExamplesSimpleio_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistExamplesSimpleio.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is ConsoleIn.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="ConsoleIn.py"
                                Show="normal" WorkingDirectory="SimpleIO"/>
                      {% endif %}
                      {% if file.Name is ConsoleOut.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="ConsoleOut.py"
                                Show="normal" WorkingDirectory="SimpleIO"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>

                <!-- SimpleService -->
                <Directory Id="SimpleService" Name="SimpleService">
                  <Component Id="RtmOpenrtm_aistExamplesSimpleservice" 
                             Guid="{% RtmOpenrtm_aistExamplesSimpleservice.GUID %}">
                    <RemoveFile Id='RtmOpenrtm_aistExamplesSimpleservice' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='RtmOpenrtm_aistExamplesSimpleservice_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistExamplesSimpleservice.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is MyServiceConsumer.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="MyServiceConsumer.py"
                                Show="normal" WorkingDirectory="SimpleService"/>
                      {% endif %}
                      {% if file.Name is MyServiceProvider.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="MyServiceProvider.py"
                                Show="normal" WorkingDirectory="SimpleService"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>

                <!-- Slider_and_Motor -->
                <Directory Id="Slider_and_Motor" Name="Slider_and_Motor">
                  <Component Id="RtmOpenrtm_aistExamplesSlider_and_motor" 
                             Guid="{% RtmOpenrtm_aistExamplesSlider_and_motor.GUID %}">
                    <RemoveFile Id='RtmOpenrtm_aistExamplesSlider_and_motor' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='RtmOpenrtm_aistExamplesSlider_and_motor_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistExamplesSlider_and_motor.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is SliderComp.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="SliderComp.py"
                                Show="normal" WorkingDirectory="Slider_and_Motor"/>
                      {% endif %}
                      {% if file.Name is TkMotorComp.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="TkMotorComp.py"
                                Show="normal" WorkingDirectory="Slider_and_Motor"/>
                      {% endif %}
                      {% if file.Name is TkMotorPosComp.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="TkMotorPosComp.py"
                                Show="normal" WorkingDirectory="Slider_and_Motor"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>

                <!-- TkJoyStick -->
                <Directory Id="TkJoyStick" Name="TkJoyStick">
                  <Component Id="RtmOpenrtm_aistExamplesTkjoystick" 
                             Guid="{% RtmOpenrtm_aistExamplesTkjoystick.GUID %}">
                    <RemoveFile Id='RtmOpenrtm_aistExamplesTkjoystick' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='RtmOpenrtm_aistExamplesTkjoystick_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistExamplesTkjoystick.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is TkJoyStickComp.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="TkJoyStickComp.py"
                                Show="normal" WorkingDirectory="TkJoyStick"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>

                <!-- TkLRFViewer -->
                <Directory Id="TkLRFViewer" Name="TkLRFViewer">
                  <Component Id="RtmOpenrtm_aistExamplesTklrfviewer" 
                             Guid="{% RtmOpenrtm_aistExamplesTklrfviewer.GUID %}">
                    <RemoveFile Id='RtmOpenrtm_aistExamplesTklrfviewer' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='RtmOpenrtm_aistExamplesTklrfviewer_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistExamplesTklrfviewer.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                      {% if file.Name is TkLRFViewer.py %}
                      <Shortcut Id="{% file.Name %}" Directory="ExpMenuFolder"
                                Name="TkLRFViewer.py"
                                Show="normal" WorkingDirectory="TkLRFViewer"/>
                      {% endif %}
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>

                <!-- Templates -->
                <Directory Id="Templates" Name="Templates">
                  <Component Id="RtmOpenrtm_aistExamplesTemplates" 
                             Guid="{% RtmOpenrtm_aistExamplesTemplates.GUID %}">
                    <RemoveFile Id='RtmOpenrtm_aistExamplesTemplates' On='uninstall' Name='*.pyc' />
                    <RemoveFolder Id='RtmOpenrtm_aistExamplesTemplates_f' On='uninstall' />
                    {% for file in RtmOpenrtm_aistExamplesTemplates.Files %}
                    <File Id="{% file.Id %}"
                          Name="{% file.Name %}" DiskId="1"
                          Source="{% file.Source %}">
                    </File>
                    {% endfor %}
                  </Component>
                </Directory>

              <!-- end of Python -->
              </Directory>

            <!-- end of examples -->
            </Directory>

            <!-- rtmtools components -->
            <?if $(env.INCLUDE_OPENRTP) = YES ?>
            <Merge Id="Msi_RTSystemEditorRCP" Language="1041"
                              SourceFile="RTSystemEditorRCP_$(env.ARCH).msm" DiskId="1" />
            <?endif ?>
            <!-- end of rtmtools -->

          </Directory>
        </Directory>

      <!-- end of Program Files Folder -->
      <?if $(env.ARCH) = "x86" ?>
      </Directory>
      <?else?>
      </Directory>
      <?endif?>

      <Directory Id="ProgramMenuFolder">
        <Directory Id="AppMenuFolder"
				   Name="{% Product.Name %} {% Product.ShortVersion %}">
          <Directory Id="PythonMenuFolder" Name="Python">
            <Directory Id="ToolsMenuFolder" Name="Tools">
            </Directory>
            <Directory Id="Components" Name="Components">
              <Directory Id="ExpMenuFolder" Name="Examples">
              </Directory>
            </Directory>
            <Directory Id="DocMenuFolder" Name="Documents">
            </Directory>
          </Directory>
          <Directory Id="CommonToolsMenuFolder" Name="Tools">
          </Directory>
        </Directory>
      </Directory>

    <!-- end of SourceDir -->
    </Directory>

    <!-- Function definition omniORBpy26 -->
    <Feature Id="omniORBpy26" Level="1" Title="OpenRTM-aist for Python 2.6"
             ConfigurableDirectory="PYTHON26DIR">
      <Condition Level="1"><![CDATA[ NOT PYTHON26 =  ""]]></Condition>
      <Condition Level="0"><![CDATA[ NOT PYTHON26 <> ""]]></Condition>

      <!-- runtime -->
      <Feature Id="Py26_Runtime" Level="1" Title="omniORBpy for Python 2.6">
        <ComponentRef Id="Py26BinX86_win32"/>
        <ComponentRef Id="Py26LibX86_win32"/>
        <ComponentRef Id="Py26LibPython"/>
        <ComponentRef Id="Py26BinDll"/>
        <ComponentRef Id="Py26LibPythonCosnaming"/>
        <ComponentRef Id="Py26LibPythonCosnaming__poa"/>
        <ComponentRef Id="Py26LibPythonOmniidl"/>
        <ComponentRef Id="Py26LibPythonOmniidl_be"/>
        <ComponentRef Id="Py26LibPythonOmniorb"/>
        <ComponentRef Id="Py26LibPythonOmniorbCos"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoscollection"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoscollection__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoscompoundlifecycle"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoscompoundlifecycle__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoscontainment"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoscontainment__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoseventchanneladmin"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoseventchanneladmin__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoseventcomm"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoseventcomm__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosexternalization"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosexternalizationcontainment"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosexternalizationcontainment__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosexternalizationreference"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosexternalizationreference__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosexternalization__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosgraphs"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosgraphs__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoslifecycle"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoslifecyclecontainment"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoslifecyclecontainment__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoslifecyclereference"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoslifecyclereference__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCoslifecycle__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosnaming"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosnaming__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosnotification"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosnotification__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosnotifychanneladmin"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosnotifychanneladmin__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosnotifycomm"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosnotifycomm__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosnotifyfilter"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosnotifyfilter__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosobjectidentity"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosobjectidentity__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospersistenceddo"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospersistenceddo__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospersistenceds_cli"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospersistenceds_cli__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospersistencepds"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospersistencepds_da"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospersistencepds_da__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospersistencepds__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospersistencepid"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospersistencepid__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospersistencepo"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospersistencepom"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospersistencepom__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospersistencepo__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospropertyservice"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCospropertyservice__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosquery"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosquerycollection"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosquerycollection__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosquery__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosreference"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosreference__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosrelationships"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosrelationships__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosstream"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCosstream__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostime"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostimerevent"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostimerevent__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostime__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostrading"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostradingdynamic"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostradingdynamic__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostradingrepos"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostradingrepos__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostrading__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostypedeventchanneladmin"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostypedeventchanneladmin__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostypedeventcomm"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostypedeventcomm__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostypednotifychanneladmin"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostypednotifychanneladmin__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostypednotifycomm"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosCostypednotifycomm__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosLifecycleservice"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosLifecycleservice__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosRditesttypes"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosRditesttypes__poa"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosTimebase"/>
        <ComponentRef Id="Py26LibPythonOmniorbCosTimebase__poa"/>
      </Feature>

      <!-- OpenRTM_aist -->
      <Feature Id="Py26_OpenRTM_aist" Level="1" Title="OpenRTM-aist (Python)"
			   ConfigurableDirectory="INSTALLLOCATION">
        <ComponentRef Id="Py26_RtmOpenrtm_aistUtilsRtcprof"/>
        <ComponentRef Id="Py26_RtmOpenrtm_aistUtilsRtcd"/>
        <ComponentRef Id="Py26_RtmOpenrtm_aistRoot"/>
        <ComponentRef Id="Py26_RtmOpenrtm_aist"/>
        <ComponentRef Id="Py26_RtmOpenrtm_aistRtctemplate"/>
        <ComponentRef Id="Py26_RtmOpenrtm_aistExt"/>
        <ComponentRef Id="Py26_RtmOpenrtm_aistExtSdo"/>
        <ComponentRef Id="Py26_RtmOpenrtm_aistExtSdoObserver"/>
        <ComponentRef Id="Py26_RtmOpenrtm_aistRtm_idl"/>
        <ComponentRef Id="Py26_RtmOpenrtm_aistRtm_idlDevice_interfaces"/>
      </Feature>
    </Feature>

    <!-- Function definition omniORBpy27 -->
    <Feature Id="omniORBpy27" Level="1" Title="OpenRTM-aist for Python 2.7"
             ConfigurableDirectory="PYTHON27DIR">
      <Condition Level="1"><![CDATA[ NOT PYTHON27 =  ""]]></Condition>
      <Condition Level="0"><![CDATA[ NOT PYTHON27 <> ""]]></Condition>

      <!-- runtime -->
      <Feature Id="Py27_Runtime" Level="1" Title="omniORBpy for Python 2.7">
        <ComponentRef Id="Py27BinX86_win32"/>
        <ComponentRef Id="Py27LibX86_win32"/>
        <ComponentRef Id="Py27LibPython"/>
        <ComponentRef Id="Py27BinDll"/>
        <ComponentRef Id="Py27LibPythonCosnaming"/>
        <ComponentRef Id="Py27LibPythonCosnaming__poa"/>
        <ComponentRef Id="Py27LibPythonOmniidl"/>
        <ComponentRef Id="Py27LibPythonOmniidl_be"/>
        <ComponentRef Id="Py27LibPythonOmniorb"/>
        <ComponentRef Id="Py27LibPythonOmniorbCos"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoscollection"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoscollection__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoscompoundlifecycle"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoscompoundlifecycle__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoscontainment"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoscontainment__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoseventchanneladmin"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoseventchanneladmin__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoseventcomm"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoseventcomm__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosexternalization"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosexternalizationcontainment"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosexternalizationcontainment__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosexternalizationreference"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosexternalizationreference__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosexternalization__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosgraphs"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosgraphs__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoslifecycle"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoslifecyclecontainment"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoslifecyclecontainment__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoslifecyclereference"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoslifecyclereference__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCoslifecycle__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosnaming"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosnaming__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosnotification"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosnotification__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosnotifychanneladmin"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosnotifychanneladmin__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosnotifycomm"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosnotifycomm__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosnotifyfilter"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosnotifyfilter__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosobjectidentity"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosobjectidentity__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospersistenceddo"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospersistenceddo__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospersistenceds_cli"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospersistenceds_cli__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospersistencepds"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospersistencepds_da"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospersistencepds_da__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospersistencepds__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospersistencepid"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospersistencepid__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospersistencepo"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospersistencepom"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospersistencepom__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospersistencepo__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospropertyservice"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCospropertyservice__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosquery"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosquerycollection"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosquerycollection__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosquery__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosreference"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosreference__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosrelationships"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosrelationships__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosstream"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCosstream__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostime"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostimerevent"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostimerevent__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostime__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostrading"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostradingdynamic"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostradingdynamic__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostradingrepos"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostradingrepos__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostrading__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostypedeventchanneladmin"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostypedeventchanneladmin__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostypedeventcomm"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostypedeventcomm__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostypednotifychanneladmin"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostypednotifychanneladmin__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostypednotifycomm"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosCostypednotifycomm__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosLifecycleservice"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosLifecycleservice__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosRditesttypes"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosRditesttypes__poa"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosTimebase"/>
        <ComponentRef Id="Py27LibPythonOmniorbCosTimebase__poa"/>
      </Feature>

      <!-- OpenRTM_aist -->
      <Feature Id="Py27_OpenRTM_aist" Level="1" Title="OpenRTM-aist (Python)"
			   ConfigurableDirectory="INSTALLLOCATION">
        <ComponentRef Id="Py27_RtmOpenrtm_aistUtilsRtcprof"/>
        <ComponentRef Id="Py27_RtmOpenrtm_aistUtilsRtcd"/>
        <ComponentRef Id="Py27_RtmOpenrtm_aistRoot"/>
        <ComponentRef Id="Py27_RtmOpenrtm_aist"/>
        <ComponentRef Id="Py27_RtmOpenrtm_aistRtctemplate"/>
        <ComponentRef Id="Py27_RtmOpenrtm_aistExt"/>
        <ComponentRef Id="Py27_RtmOpenrtm_aistExtSdo"/>
        <ComponentRef Id="Py27_RtmOpenrtm_aistExtSdoObserver"/>
        <ComponentRef Id="Py27_RtmOpenrtm_aistRtm_idl"/>
        <ComponentRef Id="Py27_RtmOpenrtm_aistRtm_idlDevice_interfaces"/>
      </Feature>
    </Feature>

    <!-- Function definition OpenRTM-aist -->
    <Feature Id="ProductFeature" Level="1" Title="OpenRTM-aist (Python) common files"
             ConfigurableDirectory="INSTALLLOCATION">

      <!-- runtime -->
      <Feature Id="Rtm_Runtime" Level="1" Title="Utility">
        <ComponentRef Id="ENV_ROOT"/>
        <ComponentRef Id="Rtm_Bin"/>
        <ComponentRef Id="Rtm_Bin2"/>
      </Feature>

      <!-- documents -->
      <Feature Id="Rtm_Docs" Level="1" Title="Documents">
        <ComponentRef Id="RtmOpenrtm_aistDocsClassreferencejpHtml"/>
        <ComponentRef Id="RtmOpenrtm_aistDocsClassreferenceenHtml"/>
      </Feature>

      <!-- examples -->
      <Feature Id="Rtm_Examples" Level="1" Title="Examples">
        <ComponentRef Id="RtmOpenrtm_aistExamples"/>
        <ComponentRef Id="RtmOpenrtm_aistExamplesAutocontrol"/>
        <ComponentRef Id="RtmOpenrtm_aistExamplesComposite"/>
        <ComponentRef Id="RtmOpenrtm_aistExamplesConfigsample"/>
        <ComponentRef Id="RtmOpenrtm_aistExamplesExttrigger"/>
        <ComponentRef Id="RtmOpenrtm_aistExamplesMobilerobotcanvas"/>
        <ComponentRef Id="RtmOpenrtm_aistExamplesNxtrtc"/>
        <ComponentRef Id="RtmOpenrtm_aistExamplesSeqio"/>
        <ComponentRef Id="RtmOpenrtm_aistExamplesSimpleio"/>
        <ComponentRef Id="RtmOpenrtm_aistExamplesSimpleservice"/>
        <ComponentRef Id="RtmOpenrtm_aistExamplesSlider_and_motor"/>
        <ComponentRef Id="RtmOpenrtm_aistExamplesTkjoystick"/>
        <ComponentRef Id="RtmOpenrtm_aistExamplesTklrfviewer"/>
        <ComponentRef Id="RtmOpenrtm_aistExamplesTemplates"/>
      </Feature>

    </Feature>

    <!-- JRE -->
    <?if $(env.INCLUDE_JRE) = YES ?>
    <Feature Id="JRE_OpenJDK" Level="1" Title="JRE for RTSystemEditorRCP 1.1">
      <MergeRef Id="Msi_JRE_OpenJDK" />
    </Feature>
    <?endif ?>

    <!-- OpenRTP tools -->
    <?if $(env.INCLUDE_OPENRTP) = YES ?>
    <Feature Id="RTSE_ONLY" Level="1" Title="RTSystemEditorRCP 1.1">
      <MergeRef Id="Msi_RTSystemEditorRCP" />
    </Feature>
    <?endif ?>

    <WixVariable Id="WixUILicenseRtf" Value="License.rtf" />
    <WixVariable Id="WixUIBannerBmp" Value="Bitmaps/bannrbmp.bmp" />
    <WixVariable Id="WixUIDialogBmp" Value="Bitmaps/dlgbmp.bmp" />
    <WixVariable Id="WixUICostingPopupOptOut" Value="1" Overridable="no" />

    <!-- <UIRef Id="WixUI_Mondo" /> -->
    <UIRef Id="WixUI_Mondo_RTM" />

    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLLOCATION" />

    <CustomAction Id='IDLCOMPILE_PY26' Directory="PYTHON26DIR"
                  ExeCommand='"[bin]idlcompile.bat" "[bin]idlcompile.py" 2.6 "[Version]examples\Python"' 
                  Return='asyncWait' />

    <CustomAction Id='IDLCOMPILE_PY27' Directory="PYTHON27DIR"
                  ExeCommand='"[bin]idlcompile.bat" "[bin]idlcompile.py" 2.7 "[Version]examples\Python"' 
                  Return='asyncWait' />

    <CustomAction Id='REMOVEFOLDER_PY26' Directory="PYTHON26DIR"
                  ExeCommand='cmd.exe /C RMDIR /Q /S Lib\\site-packages\\OpenRTM_aist' Return='ignore' />

    <CustomAction Id='REMOVEFOLDER_PY27' Directory="PYTHON27DIR"
                  ExeCommand='cmd.exe /C RMDIR /Q /S Lib\\site-packages\\OpenRTM_aist' Return='ignore' />

    <CustomAction Id='REMOVEFOLDER_RTM' Directory="INSTALLLOCATION"
                  ExeCommand='cmd.exe /C RMDIR /Q /S {% Product.ShortVersion %}\\examples\\Python' Return='ignore' />

  <?if $(env.ARCH) = x86 ?>
  </Product>
  <?else?>
  </Product>
  <?endif ?>
</Wix>
